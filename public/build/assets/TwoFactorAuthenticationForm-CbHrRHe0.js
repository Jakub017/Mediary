import{r as p,G as q,c as a,o as t,a as l,j as n,k as R,m as s,s as i,n as z,t as h,$ as B,B as U,b as W,y as E,h as Q,M as D,p as v,d as m,u as S,F as G,x as I,W as A}from"./app-Cx-ppWHZ.js";import{b as O,a as Z}from"./DialogModal-BQwMFXSD.js";import{_ as K}from"./InputError-D3e0QpcS.js";import{_ as $}from"./PrimaryButton-CvrORxcs.js";import{_ as j}from"./SecondaryButton-DF-JYZ33.js";import{_ as M}from"./TextInput-DmyVKfDo.js";import{_ as J}from"./DangerButton-DzJaGzKz.js";import{_ as X}from"./InputLabel-CatPoSp_.js";import"./SectionTitle.vue_vue_type_script_setup_true_lang-5Ya4DRZV.js";const Y={class:"mt-4"},_={__name:"ConfirmsPassword",props:{title:{type:String,default:"Potwierdź hasło"},content:{type:String,default:"Potwierdź hasło, aby kontynuować."},button:{type:String,default:"Potwierdź"}},emits:["confirmed"],setup(g,{emit:C}){const b=C,u=p(!1),e=q({password:"",error:"",processing:!1}),c=p(null),k=()=>{axios.get(route("password.confirmation")).then(r=>{r.data.confirmed?b("confirmed"):(u.value=!0,setTimeout(()=>c.value.focus(),250))})},y=()=>{e.processing=!0,axios.post(route("password.confirm"),{password:e.password}).then(()=>{e.processing=!1,f(),U().then(()=>b("confirmed"))}).catch(r=>{e.processing=!1,e.error=r.response.data.errors.password[0],c.value.focus()})},f=()=>{u.value=!1,e.password="",e.error=""};return(r,d)=>(t(),a("span",null,[l("span",{onClick:k},[R(r.$slots,"default")]),n(O,{show:u.value,onClose:f},{title:s(()=>[i(h(g.title),1)]),content:s(()=>[i(h(g.content)+" ",1),l("div",Y,[n(M,{ref_key:"passwordInput",ref:c,modelValue:e.password,"onUpdate:modelValue":d[0]||(d[0]=P=>e.password=P),type:"Hasło",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:B(y,["enter"])},null,8,["modelValue"]),n(K,{message:e.error,class:"mt-2"},null,8,["message"])])]),footer:s(()=>[n(j,{onClick:f},{default:s(()=>d[1]||(d[1]=[i(" Anuluj ")])),_:1,__:[1]}),n($,{class:z(["ms-3",{"opacity-25":e.processing}]),disabled:e.processing,onClick:y},{default:s(()=>[i(h(g.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},ee={key:0,class:"text-lg font-medium text-green-600"},oe={key:1,class:"text-lg font-medium text-gray-900"},te={key:2,class:"text-lg font-medium text-red-600"},se={key:3},ae={key:0},ne={class:"mt-4 max-w-xl text-sm text-gray-600"},ie={key:0,class:"font-semibold"},re={key:1},le=["innerHTML"],ue={key:0,class:"mt-4 max-w-xl text-sm text-gray-600"},de={class:"font-semibold"},ce=["innerHTML"],me={key:1,class:"mt-4"},fe={key:1},we={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},pe={class:"mt-5"},ye={key:0},ke={key:1,class:"flex items-center"},Pe={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(g){const C=g,b=W(),u=p(!1),e=p(!1),c=p(!1),k=p(null),y=p(null),f=p([]),r=E({code:""}),d=Q(()=>{var w;return!u.value&&((w=b.props.auth.user)==null?void 0:w.two_factor_enabled)});D(d,()=>{d.value||(r.reset(),r.clearErrors())});const P=()=>{u.value=!0,A.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([N(),H(),T()]),onFinish:()=>{u.value=!1,e.value=C.requiresConfirmation}})},N=()=>axios.get(route("two-factor.qr-code")).then(w=>{k.value=w.data.svg}),H=()=>axios.get(route("two-factor.secret-key")).then(w=>{y.value=w.data.secretKey}),T=()=>axios.get(route("two-factor.recovery-codes")).then(w=>{f.value=w.data}),F=()=>{r.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{e.value=!1,k.value=null,y.value=null}})},L=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>T())},V=()=>{c.value=!0,A.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{c.value=!1,e.value=!1}})};return(w,o)=>(t(),v(Z,{icon:"lock"},{title:s(()=>o[1]||(o[1]=[i(" Uwierzytelnianie dwuskładnikowe ")])),description:s(()=>o[2]||(o[2]=[i(" Zwiększ bezpieczeństwo swojego konta, korzystając z uwierzytelniania dwuskładnikowego. ")])),content:s(()=>[d.value&&!e.value?(t(),a("h3",ee," Na twoim koncie działa uwierzytelnianie dwuskładnikowe ")):d.value&&e.value?(t(),a("h3",oe," Dokończ konfigurację uwierzytelniania dwuskładnikowego ")):(t(),a("h3",te," Na twoim koncie nie działa uwierzytelnianie dwuskładnikowe ")),o[11]||(o[11]=l("div",{class:"mt-2 max-w-xl text-sm text-gray-600"},[l("p",null," Po włączeniu uwierzytelniania dwuskładnikowego podczas uwierzytelniania pojawi się monit o podanie bezpiecznego, losowego tokenu. Token ten można pobrać z aplikacji Google Authenticator na telefonie. ")],-1)),d.value?(t(),a("div",se,[k.value?(t(),a("div",ae,[l("div",ne,[e.value?(t(),a("p",ie," Aby zakończyć proces włączania uwierzytelniania dwuskładnikowego, zeskanuj poniższy kod QR za pomocą aplikacji uwierzytelniającej w telefonie lub wprowadź klucz konfiguracyjny i podaj wygenerowany kod OTP. ")):(t(),a("p",re," Uwierzytelnianie dwuskładnikowe jest teraz włączone. Zeskanuj poniższy kod QR za pomocą aplikacji uwierzytelniającej w telefonie lub wprowadź klucz konfiguracyjny. "))]),l("div",{class:"mt-4 p-2 inline-block bg-white",innerHTML:k.value},null,8,le),y.value?(t(),a("div",ue,[l("p",de,[o[3]||(o[3]=i(" Klucz konfiguracyjny: ")),l("span",{innerHTML:y.value},null,8,ce)])])):m("",!0),e.value?(t(),a("div",me,[n(X,{for:"code",value:"Code"}),n(M,{id:"code",modelValue:S(r).code,"onUpdate:modelValue":o[0]||(o[0]=x=>S(r).code=x),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:B(F,["enter"])},null,8,["modelValue"]),n(K,{message:S(r).errors.code,class:"mt-2"},null,8,["message"])])):m("",!0)])):m("",!0),f.value.length>0&&!e.value?(t(),a("div",fe,[o[4]||(o[4]=l("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[l("p",{class:"font-semibold"}," Przechowuj te kody odzyskiwania w bezpiecznym menedżerze haseł. Można ich użyć do odzyskania dostępu do konta, jeśli zgubisz urządzenie do uwierzytelniania dwuskładnikowego. ")],-1)),l("div",we,[(t(!0),a(G,null,I(f.value,x=>(t(),a("div",{key:x},h(x),1))),128))])])):m("",!0)])):m("",!0),l("div",pe,[d.value?(t(),a("div",ke,[n(_,{onConfirmed:F},{default:s(()=>[e.value?(t(),v($,{key:0,type:"button",class:z(["me-3",{"opacity-25":u.value}]),disabled:u.value},{default:s(()=>o[6]||(o[6]=[i(" Potwierdź ")])),_:1,__:[6]},8,["class","disabled"])):m("",!0)]),_:1}),n(_,{onConfirmed:L},{default:s(()=>[f.value.length>0&&!e.value?(t(),v(j,{key:0,class:"me-3"},{default:s(()=>o[7]||(o[7]=[i(" Odzyskaj kody odzyskiwania ")])),_:1,__:[7]})):m("",!0)]),_:1}),n(_,{onConfirmed:T},{default:s(()=>[f.value.length===0&&!e.value?(t(),v(j,{key:0,class:"me-3"},{default:s(()=>o[8]||(o[8]=[i(" Pokaż kody odzyskiwania ")])),_:1,__:[8]})):m("",!0)]),_:1}),n(_,{onConfirmed:V},{default:s(()=>[e.value?(t(),v(j,{key:0,class:z({"opacity-25":c.value}),disabled:c.value},{default:s(()=>o[9]||(o[9]=[i(" Anuluj ")])),_:1,__:[9]},8,["class","disabled"])):m("",!0)]),_:1}),n(_,{onConfirmed:V},{default:s(()=>[e.value?m("",!0):(t(),v(J,{key:0,class:z({"opacity-25":c.value}),disabled:c.value},{default:s(()=>o[10]||(o[10]=[i(" Wyłącz ")])),_:1,__:[10]},8,["class","disabled"]))]),_:1})])):(t(),a("div",ye,[n(_,{onConfirmed:P},{default:s(()=>[n($,{type:"button",class:z({"opacity-25":u.value}),disabled:u.value},{default:s(()=>o[5]||(o[5]=[i(" Włącz ")])),_:1,__:[5]},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{Pe as default};
